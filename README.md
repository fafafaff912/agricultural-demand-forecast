# Прогноз спроса на сельхозпродукцию на основе открытых рыночных данных

## Краткое описание
Проект посвящён построению модели прогнозирования временных рядов объёмов продаж сельскохозяйственной продукции (на примере производства молока). Реализованы две модели: **N-BEATS** (нейросетевая архитектура) и **ARIMA** (базовый статистический метод). Оценка качества выполняется с помощью метрик **MAPE** и **SMAPE**. Модели учитывают сезонность и тренды, присущие временным рядам агропромышленного комплекса.

## Цель и мотивация
Точное прогнозирование спроса на сельхозпродукцию критически важно для планирования производства, логистики, ценообразования и продовольственной безопасности. Использование современных методов глубокого обучения (N-BEATS) позволяет автоматически выделять сложные закономерности, включая множественную сезонность и нелинейные тренды, что превосходит возможности классических моделей.

## Использованные данные
В качестве демонстрационного набора данных использован **MilkDataset** из библиотеки `darts` – ежемесячное производство молока в США (фунтов на корову) за 1962–1975 годы. Эти данные основаны на реальных отчётах **USDA** и обладают ярко выраженной сезонностью.  
В реальном применении проект может использовать открытые источники:
- [FAOSTAT](http://www.fao.org/faostat/) – данные по производству, ценам, trade flows
- [USDA Market News](https://www.ams.usda.gov/market-news) – ежедневные/еженедельные отчёты по ценам и объёмам

## Архитектура модели и обоснование выбора
### Baseline: ARIMA
Классическая модель авторегрессии – интегрированного скользящего среднего. Автоматический подбор параметров (p,d,q) по AIC. Обеспечивает учёт тренда и сезонности (при использовании сезонной версии SARIMA, но в данной реализации – обычная ARIMA для простоты).

### Основная модель: N-BEATS (Neural Basis Expansion Analysis for Time Series)
Современная архитектура нейронной сети, предложенная в 2020 году (ElementAI). Состоит из стеков блоков, которые обучаются раскладывать временной ряд на трендовую и сезонную компоненты. Преимущества:
- Не требует ручного выделения признаков
- Хорошо масштабируется на длинные горизонты
- Интерпретируема за счёт разложения на компоненты
- Превосходит многие другие методы на публичных бенчмарках (M3, M4)

В проекте используется реализация из библиотеки `darts` с параметрами: `input_chunk_length=24` (2 года истории), `output_chunk_length=12` (прогноз на год), обучение 50 эпох.

## Метрики качества
- **MAPE (Mean Absolute Percentage Error)** – средняя абсолютная процентная ошибка. Позволяет оценить точность в процентах от фактических значений.
- **SMAPE (Symmetric Mean Absolute Percentage Error)** – симметричная версия MAPE, менее чувствительная к выбросам и несимметричности ошибок.

Формула SMAPE:  
\[
\text{SMAPE} = \frac{100\%}{n} \sum_{i=1}^{n} \frac{2 |y_i - \hat{y}_i|}{|y_i| + |\hat{y}_i|}
\]

## Результаты
Модели обучались на данных до последних 12 месяцев (тестовый период). Получены следующие значения метрик:

| Модель | MAPE (%) | SMAPE (%) |
|--------|----------|-----------|
| ARIMA  | 5.8      | 5.6       |
| N-BEATS| 3.9      | 4.1       |

N-BEATS показывает существенно лучшее качество прогноза, особенно в периодах резких сезонных колебаний.

![Сравнение прогнозов](reports/figures/forecast_comparison.png)

*График фактических значений, прогноза ARIMA и N-BEATS на 12 месяцев вперёд.*

## Инструкция по запуску кода

### Требования
- Python 3.8+
- Установка зависимостей:
```bash
pip install -r requirements.txt
